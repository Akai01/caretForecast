<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Forecasting grouped time series using caret — ARml_grouped • caretForecast</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Forecasting grouped time series using caret — ARml_grouped" />
<meta property="og:description" content="
Forecasting grouped time series using caret" />


<meta name="robots" content="noindex">

<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">caretForecast</a>
        <span class="version label label-info" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/Akai01/caretForecast/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Forecasting grouped time series using caret</h1>
    <small class="dont-index">Source: <a href='https://github.com/Akai01/caretForecast/blob/master/R/arml_grouped.R'><code>R/arml_grouped.R</code></a></small>
    <div class="hidden name"><code>ARml_grouped.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><a href='https://www.tidyverse.org/lifecycle/#experimental'><img src='figures/lifecycle-experimental.svg' alt='Experimental lifecycle'></a></p>
<p>Forecasting grouped time series using caret</p>
    </div>

    <pre class="usage"><span class='fu'>ARml_grouped</span><span class='op'>(</span>
  <span class='va'>data</span>,
  <span class='va'>outcome_col_name</span>,
  date_col <span class='op'>=</span> <span class='fl'>1</span>,
  horizons <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>6</span>, <span class='fl'>12</span><span class='op'>)</span>,
  lookback <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>)</span>,
  frequency <span class='op'>=</span> <span class='st'>"1 month"</span>,
  groups <span class='op'>=</span> <span class='cn'>NULL</span>,
  dynamic_features <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"month"</span>, <span class='st'>"year"</span>, <span class='st'>"week"</span>, <span class='st'>"day"</span>, <span class='st'>"quarter"</span><span class='op'>)</span>,
  static_features <span class='op'>=</span> <span class='cn'>NULL</span>,
  train_control <span class='op'>=</span> <span class='fu'>caret</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/caret/man/trainControl.html'>trainControl</a></span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"cv"</span>, number <span class='op'>=</span> <span class='fl'>3</span>, p <span class='op'>=</span> <span class='fl'>0.75</span>, search <span class='op'>=</span>
    <span class='st'>"grid"</span>, selectionFunction <span class='op'>=</span> <span class='st'>"best"</span>, verboseIter <span class='op'>=</span> <span class='cn'>T</span>, trim <span class='op'>=</span> <span class='cn'>FALSE</span>, allowParallel <span class='op'>=</span>
    <span class='cn'>FALSE</span><span class='op'>)</span>,
  ncore <span class='op'>=</span> <span class='fl'>2</span>,
  tune_grid <span class='op'>=</span> <span class='cn'>NULL</span>,
  pre_process <span class='op'>=</span> <span class='cn'>NULL</span>,
  weights <span class='op'>=</span> <span class='cn'>NULL</span>,
  caret_method <span class='op'>=</span> <span class='st'>"lm"</span>,
  metric <span class='op'>=</span> <span class='st'>"RMSE"</span>,
  return_model <span class='op'>=</span> <span class='cn'>TRUE</span>,
  return_input_data <span class='op'>=</span> <span class='cn'>FALSE</span>,
  return_all_horizon_forecast <span class='op'>=</span> <span class='cn'>FALSE</span>,
  return_fitted_values <span class='op'>=</span> <span class='cn'>TRUE</span>,
  set_seed <span class='op'>=</span> <span class='fl'>42</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>A grouped time series class of data.frame</p></td>
    </tr>
    <tr>
      <th>outcome_col_name</th>
      <td><p>Names of the output column</p></td>
    </tr>
    <tr>
      <th>date_col</th>
      <td><p>An integer indicating the location of the date column</p></td>
    </tr>
    <tr>
      <th>horizons</th>
      <td><p>A numeric vector of one or more forecast horizons, h,
measured in dataset rows.If dates are given, a horizon of 1, for example,
would equal 1 * frequency in calendar time.</p></td>
    </tr>
    <tr>
      <th>lookback</th>
      <td><p>A numeric vector giving the lags–in dataset rows–for creating
the lagged features.
All non-grouping, non-static, and non-dynamic features in the input dataset,
data, are lagged by the same values.
The outcome is also lagged by default. Either lookback or lookback_control
need to be specified–but not both.</p></td>
    </tr>
    <tr>
      <th>frequency</th>
      <td><p>Date/time frequency. Required if dates are given.
A string taking the same input as base::seq.Date(..., by = "frequency") or
base::seq.POSIXt(..., by = "frequency") e.g., '1 hour', '1 month', '7 days',
'10 years' etc.
The highest frequency supported at present is '1 sec'.</p></td>
    </tr>
    <tr>
      <th>groups</th>
      <td><p>A character vector of column names that identify
the groups/hierarchies when multiple time series are present.
These columns are used as model features but are not lagged.
Note that combining feature lags with grouped time series will result in
NA values throughout the data.</p></td>
    </tr>
    <tr>
      <th>dynamic_features</th>
      <td><p>A character vector to define date features, "month",
"year", "week", "day", "quarter" are supported features.</p></td>
    </tr>
    <tr>
      <th>static_features</th>
      <td><p>For grouped time series only.
A character vector of column names that identify features that do not change
through time.
These columns are not lagged.
If type = "forecast", these features will be filled forward using the
most recent value for the group.</p></td>
    </tr>
    <tr>
      <th>train_control</th>
      <td><p>Control parameters for caret train see
<code><a href='https://rdrr.io/pkg/caret/man/trainControl.html'>trainControl</a></code></p></td>
    </tr>
    <tr>
      <th>ncore</th>
      <td><p>If <code>allowParallel = TRUE</code> in
<code><a href='https://rdrr.io/pkg/caret/man/trainControl.html'>trainControl</a></code>
user can specify number of cores to be used.</p></td>
    </tr>
    <tr>
      <th>tune_grid</th>
      <td><p>A data frame with possible tuning values.
The columns are named the same as the tuning parameters.
Use getModelInfo to get a list of tuning parameters for each model or see
<a href='http://topepo.github.io/caret/available-models.html'>http://topepo.github.io/caret/available-models.html</a>.
(NOTE: If given, this argument must be named.)</p></td>
    </tr>
    <tr>
      <th>pre_process</th>
      <td><p>A string vector that defines a pre-processing of the
predictor data.
Current possibilities are "BoxCox", "YeoJohnson", "expoTrans", "center",
"scale", "range",
"knnImpute", "bagImpute", "medianImpute", "pca", "ica" and "spatialSign".
The default is no pre-processing.
See preProcess and trainControl on the procedures and how to adjust them.
Pre-processing code is only designed to work when x is a simple matrix or
data frame.</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>A numeric vector of case weights.
This argument will only affect models that allow case weights.</p></td>
    </tr>
    <tr>
      <th>caret_method</th>
      <td><p>A string (or a self defined model list see
<a href='http://topepo.github.io/caret/using-your-own-model-in-train.html'>http://topepo.github.io/caret/using-your-own-model-in-train.html</a>)
specifying which classification or regression model to use.
Possible values are found using names(getModelInfo()).
See  <a href='http://topepo.github.io/caret/train-models-by-tag.html'>http://topepo.github.io/caret/train-models-by-tag.html</a>.
A list of functions can also be passed for a custom model function.
See <a href='http://topepo.github.io/caret/using-your-own-model-in-train.html'>http://topepo.github.io/caret/using-your-own-model-in-train.html</a>
for details.</p></td>
    </tr>
    <tr>
      <th>metric</th>
      <td><p>A string that specifies what summary metric will be used to
select the optimal model.
By default, possible values are "RMSE" and "Rsquared" for regression and
"Accuracy" and "Kappa" for classification.
If custom performance metrics are used (via the summaryFunction argument in
trainControl, the value of metric should match one of the arguments.
If it does not, a warning is issued and the first metric given by the
summaryFunction is used.
(NOTE: If given, this argument must be named.)</p></td>
    </tr>
    <tr>
      <th>return_model</th>
      <td><p>Boolean. If <code>TRUE</code> trained model will be returned.</p></td>
    </tr>
    <tr>
      <th>return_input_data</th>
      <td><p>Boolean. If <code>TRUE</code> input data will be returned.</p></td>
    </tr>
    <tr>
      <th>return_all_horizon_forecast</th>
      <td><p>Boolean. If <code>TRUE</code> forecast
from all horizon forecast  will be returned.</p></td>
    </tr>
    <tr>
      <th>return_fitted_values</th>
      <td><p>Boolean. If <code>TRUE</code>fitted values will be
returned.</p></td>
    </tr>
    <tr>
      <th>set_seed</th>
      <td><p>set random number generation</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Resul Akay</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'> <span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>

<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>retail</span>, package <span class='op'>=</span> <span class='st'>"MLforecast"</span><span class='op'>)</span>

<span class='va'>fc</span> <span class='op'>&lt;-</span> <span class='fu'>ARml_grouped</span><span class='op'>(</span><span class='va'>retail</span>, outcome_col_name <span class='op'>=</span> <span class='st'>"value"</span>,
                  date_col <span class='op'>=</span> <span class='fl'>1</span>,
                  horizons <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>9</span>, <span class='fl'>18</span><span class='op'>)</span>,
                  lookback <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>24</span><span class='op'>)</span>,
                  frequency <span class='op'>=</span> <span class='st'>"1 month"</span>,
                  groups <span class='op'>=</span> <span class='st'>"items"</span>,
                  dynamic_features <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"month"</span>, <span class='st'>"year"</span>, <span class='st'>"quarter"</span><span class='op'>)</span>,
                  caret_method <span class='op'>=</span> <span class='st'>"cubist"</span>,
                  return_model <span class='op'>=</span> <span class='cn'>F</span>,
                 return_input_data <span class='op'>=</span> <span class='cn'>F</span>,
                  return_all_horizon_forecast <span class='op'>=</span> <span class='cn'>TRUE</span>,
                  return_fitted_values <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>



<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>fc</span><span class='op'>$</span><span class='va'>fitted_values</span>, group_filter <span class='op'>=</span> <span class='st'>"items == 'V10'"</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>fc</span><span class='op'>$</span><span class='va'>combined_forecasts</span>, data_actual <span class='op'>=</span> <span class='va'>retail</span>,
    actual_indices <span class='op'>=</span> <span class='va'>retail</span><span class='op'>$</span><span class='va'>date</span>, group_filter <span class='op'>=</span> <span class='st'>"items == 'V3'"</span><span class='op'>)</span>
<span class='op'>}</span>




</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Resul Akay.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>



<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>caretForecast • caretForecast</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="caretForecast">
<meta name="description" content="Conformal Time Series Forecasting Using Machine Learning">
<meta property="og:description" content="Conformal Time Series Forecasting Using Machine Learning">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">caretForecast</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/taf-society/caretForecast" aria-label="GitHub"><span class="fa fab fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="caretforecast">caretForecast<a class="anchor" aria-label="anchor" href="#caretforecast"></a>
</h1></div>
<!-- badges: start -->

<p>caretForecast aspires to equip users with the means of using machine learning algorithms for time series data forecasting.</p>
<div class="section level2">
<h2 id="features">Features<a class="anchor" aria-label="anchor" href="#features"></a>
</h2>
<ul>
<li>Use any regression model from the caret package for time series forecasting</li>
<li>Automatic feature engineering with lagged values and Fourier terms for seasonality</li>
<li>
<strong>Horizon-specific conformal prediction intervals</strong> with proper out-of-sample calibration</li>
<li>Support for external regressors (promotions, holidays, etc.)</li>
<li>Compatible with hierarchical/grouped time series via the hts package</li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>The CRAN version with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"caretForecast"</span><span class="op">)</span></span></code></pre></div>
<p>The development version from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"taf-society/caretForecast"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>By using caretForecast, users can train any regression model that is compatible with the caret package. This allows them to use any machine learning model they need in order to solve specific problems, as shown by the examples below.</p>
<div class="section level3">
<h3 id="load-the-library">Load the library<a class="anchor" aria-label="anchor" href="#load-the-library"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://taf-society.github.io/caretForecast/">caretForecast</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Registered S3 method overwritten by 'quantmod':</span></span>
<span><span class="co">#&gt;   method            from</span></span>
<span><span class="co">#&gt;   as.zoo.data.frame zoo</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">retail_wide</span>, package <span class="op">=</span> <span class="st">"caretForecast"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="forecasting-with-glmboost">Forecasting with glmboost<a class="anchor" aria-label="anchor" href="#forecasting-with-glmboost"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fl">8</span></span>
<span></span>
<span><span class="va">dtlist</span> <span class="op">&lt;-</span> <span class="fu">caretForecast</span><span class="fu">::</span><span class="fu"><a href="reference/split_ts.html">split_ts</a></span><span class="op">(</span><span class="va">retail_wide</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span>, test_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">training_data</span> <span class="op">&lt;-</span> <span class="va">dtlist</span><span class="op">$</span><span class="va">train</span></span>
<span></span>
<span><span class="va">testing_data</span> <span class="op">&lt;-</span> <span class="va">dtlist</span><span class="op">$</span><span class="va">test</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ARml.html">ARml</a></span><span class="op">(</span><span class="va">training_data</span>, max_lag <span class="op">=</span> <span class="fl">12</span>, caret_method <span class="op">=</span> <span class="st">"cubist"</span>, </span>
<span>            verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; initial_window = NULL. Setting initial_window = 301</span></span>
<span><span class="co">#&gt; Loading required package: ggplot2</span></span>
<span><span class="co">#&gt; Loading required package: lattice</span></span>
<span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/forecast.html" class="external-link">forecast</a></span><span class="op">(</span><span class="va">fit</span>, h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">testing_data</span><span class="op">)</span>, level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">80</span>,<span class="fl">95</span><span class="op">)</span><span class="op">)</span><span class="op">-&gt;</span> <span class="va">fc</span></span>
<span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/accuracy.html" class="external-link">accuracy</a></span><span class="op">(</span><span class="va">fc</span>, <span class="va">testing_data</span><span class="op">)</span></span>
<span><span class="co">#&gt;                     ME      RMSE       MAE        MPE     MAPE      MASE</span></span>
<span><span class="co">#&gt; Training set 0.3616104  8.550244  6.349603 -0.0727533 3.243307 0.4120175</span></span>
<span><span class="co">#&gt; Test set     2.4886342 15.770333 11.247363  1.1450840 3.448918 0.7298268</span></span>
<span><span class="co">#&gt;                   ACF1 Theil's U</span></span>
<span><span class="co">#&gt; Training set 0.2754280        NA</span></span>
<span><span class="co">#&gt; Test set     0.3447055 0.5827831</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">fc</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autolayer.html" class="external-link">autolayer</a></span><span class="op">(</span><span class="va">testing_data</span>, series <span class="op">=</span> <span class="st">"testing_data"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example2-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="forecasting-with-cubist-regression">Forecasting with cubist regression<a class="anchor" aria-label="anchor" href="#forecasting-with-cubist-regression"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fl">9</span></span>
<span></span>
<span><span class="va">dtlist</span> <span class="op">&lt;-</span> <span class="fu">caretForecast</span><span class="fu">::</span><span class="fu"><a href="reference/split_ts.html">split_ts</a></span><span class="op">(</span><span class="va">retail_wide</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span>, test_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">training_data</span> <span class="op">&lt;-</span> <span class="va">dtlist</span><span class="op">$</span><span class="va">train</span></span>
<span></span>
<span><span class="va">testing_data</span> <span class="op">&lt;-</span> <span class="va">dtlist</span><span class="op">$</span><span class="va">test</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ARml.html">ARml</a></span><span class="op">(</span><span class="va">training_data</span>, max_lag <span class="op">=</span> <span class="fl">12</span>, caret_method <span class="op">=</span> <span class="st">"cubist"</span>, </span>
<span>            verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; initial_window = NULL. Setting initial_window = 301</span></span>
<span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/forecast.html" class="external-link">forecast</a></span><span class="op">(</span><span class="va">fit</span>, h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">testing_data</span><span class="op">)</span>, level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">80</span>,<span class="fl">95</span><span class="op">)</span>, PI <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">-&gt;</span> <span class="va">fc</span></span>
<span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/accuracy.html" class="external-link">accuracy</a></span><span class="op">(</span><span class="va">fc</span>, <span class="va">testing_data</span><span class="op">)</span></span>
<span><span class="co">#&gt;                       ME     RMSE      MAE        MPE     MAPE      MASE</span></span>
<span><span class="co">#&gt; Training set   0.5498926 13.33516 10.36501  0.0394589 2.223005 0.3454108</span></span>
<span><span class="co">#&gt; Test set     -17.9231242 47.13871 32.03537 -2.6737257 4.271373 1.0675691</span></span>
<span><span class="co">#&gt;                   ACF1 Theil's U</span></span>
<span><span class="co">#&gt; Training set 0.3979153        NA</span></span>
<span><span class="co">#&gt; Test set     0.4934659 0.4736043</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">fc</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autolayer.html" class="external-link">autolayer</a></span><span class="op">(</span><span class="va">testing_data</span>, series <span class="op">=</span> <span class="st">"testing_data"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example3-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="forecasting-using-support-vector-machines-with-linear-kernel">Forecasting using Support Vector Machines with Linear Kernel<a class="anchor" aria-label="anchor" href="#forecasting-using-support-vector-machines-with-linear-kernel"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fl">9</span></span>
<span></span>
<span><span class="va">dtlist</span> <span class="op">&lt;-</span> <span class="fu">caretForecast</span><span class="fu">::</span><span class="fu"><a href="reference/split_ts.html">split_ts</a></span><span class="op">(</span><span class="va">retail_wide</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span>, test_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">training_data</span> <span class="op">&lt;-</span> <span class="va">dtlist</span><span class="op">$</span><span class="va">train</span></span>
<span></span>
<span><span class="va">testing_data</span> <span class="op">&lt;-</span> <span class="va">dtlist</span><span class="op">$</span><span class="va">test</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ARml.html">ARml</a></span><span class="op">(</span><span class="va">training_data</span>, max_lag <span class="op">=</span> <span class="fl">12</span>, caret_method <span class="op">=</span> <span class="st">"svmLinear2"</span>, </span>
<span>            verbose <span class="op">=</span> <span class="cn">FALSE</span>, pre_process <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"scale"</span>, <span class="st">"center"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; initial_window = NULL. Setting initial_window = 301</span></span>
<span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/forecast.html" class="external-link">forecast</a></span><span class="op">(</span><span class="va">fit</span>, h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">testing_data</span><span class="op">)</span>, level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">80</span>,<span class="fl">95</span><span class="op">)</span>, PI <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">-&gt;</span> <span class="va">fc</span></span>
<span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/accuracy.html" class="external-link">accuracy</a></span><span class="op">(</span><span class="va">fc</span>, <span class="va">testing_data</span><span class="op">)</span></span>
<span><span class="co">#&gt;                      ME     RMSE      MAE        MPE     MAPE      MASE</span></span>
<span><span class="co">#&gt; Training set -0.2227708 22.66741 17.16009 -0.2476916 3.712496 0.5718548</span></span>
<span><span class="co">#&gt; Test set     -1.4732653 28.47932 22.92438 -0.4787467 2.883937 0.7639481</span></span>
<span><span class="co">#&gt;                   ACF1 Theil's U</span></span>
<span><span class="co">#&gt; Training set 0.3290937        NA</span></span>
<span><span class="co">#&gt; Test set     0.3863955 0.3137822</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">fc</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autolayer.html" class="external-link">autolayer</a></span><span class="op">(</span><span class="va">testing_data</span>, series <span class="op">=</span> <span class="st">"testing_data"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example4-1.png" width="100%"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="reference/get_var_imp.html">get_var_imp</a></span><span class="op">(</span><span class="va">fc</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example4-2.png" width="100%"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="reference/get_var_imp.html">get_var_imp</a></span><span class="op">(</span><span class="va">fc</span>, plot <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="co">#&gt; loess r-squared variable importance</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   only 20 most important variables shown (out of 23)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Overall</span></span>
<span><span class="co">#&gt; lag12 100.0000</span></span>
<span><span class="co">#&gt; lag1   83.9153</span></span>
<span><span class="co">#&gt; lag11  80.4644</span></span>
<span><span class="co">#&gt; lag2   79.9170</span></span>
<span><span class="co">#&gt; lag3   79.5019</span></span>
<span><span class="co">#&gt; lag4   78.3472</span></span>
<span><span class="co">#&gt; lag9   78.1634</span></span>
<span><span class="co">#&gt; lag5   78.0262</span></span>
<span><span class="co">#&gt; lag7   77.9153</span></span>
<span><span class="co">#&gt; lag8   76.7721</span></span>
<span><span class="co">#&gt; lag10  76.4275</span></span>
<span><span class="co">#&gt; lag6   75.7056</span></span>
<span><span class="co">#&gt; S1-12   3.8169</span></span>
<span><span class="co">#&gt; S3-12   2.4230</span></span>
<span><span class="co">#&gt; C2-12   2.1863</span></span>
<span><span class="co">#&gt; S5-12   2.1154</span></span>
<span><span class="co">#&gt; C4-12   1.9426</span></span>
<span><span class="co">#&gt; C1-12   0.5974</span></span>
<span><span class="co">#&gt; C6-12   0.3883</span></span>
<span><span class="co">#&gt; S2-12   0.2220</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="forecasting-using-ridge-regression">Forecasting using Ridge Regression<a class="anchor" aria-label="anchor" href="#forecasting-using-ridge-regression"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fl">8</span></span>
<span></span>
<span><span class="va">dtlist</span> <span class="op">&lt;-</span> <span class="fu">caretForecast</span><span class="fu">::</span><span class="fu"><a href="reference/split_ts.html">split_ts</a></span><span class="op">(</span><span class="va">retail_wide</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span>, test_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">training_data</span> <span class="op">&lt;-</span> <span class="va">dtlist</span><span class="op">$</span><span class="va">train</span></span>
<span></span>
<span><span class="va">testing_data</span> <span class="op">&lt;-</span> <span class="va">dtlist</span><span class="op">$</span><span class="va">test</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ARml.html">ARml</a></span><span class="op">(</span><span class="va">training_data</span>, max_lag <span class="op">=</span> <span class="fl">12</span>, caret_method <span class="op">=</span> <span class="st">"ridge"</span>, </span>
<span>            verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; initial_window = NULL. Setting initial_window = 301</span></span>
<span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/forecast.html" class="external-link">forecast</a></span><span class="op">(</span><span class="va">fit</span>, h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">testing_data</span><span class="op">)</span>, level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">80</span>,<span class="fl">95</span><span class="op">)</span>, PI <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">-&gt;</span> <span class="va">fc</span></span>
<span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/accuracy.html" class="external-link">accuracy</a></span><span class="op">(</span><span class="va">fc</span>, <span class="va">testing_data</span><span class="op">)</span></span>
<span><span class="co">#&gt;                       ME     RMSE      MAE        MPE     MAPE      MASE</span></span>
<span><span class="co">#&gt; Training set 7.11464e-14 12.69082  9.53269 -0.1991292 5.212444 0.6185639</span></span>
<span><span class="co">#&gt; Test set     1.52445e+00 14.45469 12.04357  0.6431543 3.880894 0.7814914</span></span>
<span><span class="co">#&gt;                   ACF1 Theil's U</span></span>
<span><span class="co">#&gt; Training set 0.2598784        NA</span></span>
<span><span class="co">#&gt; Test set     0.3463574 0.5056792</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">fc</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autolayer.html" class="external-link">autolayer</a></span><span class="op">(</span><span class="va">testing_data</span>, series <span class="op">=</span> <span class="st">"testing_data"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example5-1.png" width="100%"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="reference/get_var_imp.html">get_var_imp</a></span><span class="op">(</span><span class="va">fc</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example5-2.png" width="100%"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="reference/get_var_imp.html">get_var_imp</a></span><span class="op">(</span><span class="va">fc</span>, plot <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="co">#&gt; loess r-squared variable importance</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   only 20 most important variables shown (out of 23)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Overall</span></span>
<span><span class="co">#&gt; lag12 100.0000</span></span>
<span><span class="co">#&gt; lag1   84.2313</span></span>
<span><span class="co">#&gt; lag2   78.9566</span></span>
<span><span class="co">#&gt; lag11  78.5354</span></span>
<span><span class="co">#&gt; lag3   76.3480</span></span>
<span><span class="co">#&gt; lag10  74.4727</span></span>
<span><span class="co">#&gt; lag4   74.1330</span></span>
<span><span class="co">#&gt; lag7   74.0737</span></span>
<span><span class="co">#&gt; lag9   73.9113</span></span>
<span><span class="co">#&gt; lag5   73.2040</span></span>
<span><span class="co">#&gt; lag8   72.7224</span></span>
<span><span class="co">#&gt; lag6   71.5713</span></span>
<span><span class="co">#&gt; S1-12   6.3658</span></span>
<span><span class="co">#&gt; S3-12   2.7341</span></span>
<span><span class="co">#&gt; C2-12   2.7125</span></span>
<span><span class="co">#&gt; S5-12   2.4858</span></span>
<span><span class="co">#&gt; C4-12   2.2137</span></span>
<span><span class="co">#&gt; C6-12   0.6381</span></span>
<span><span class="co">#&gt; C1-12   0.5176</span></span>
<span><span class="co">#&gt; S2-12   0.4464</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="adding-external-variables">Adding external variables<a class="anchor" aria-label="anchor" href="#adding-external-variables"></a>
</h2>
<p>The xreg argument can be used for adding promotions, holidays, and other external variables to the model. In the example below, we will add seasonal dummies to the model. We set the ‘seasonal = FALSE’ to avoid adding the Fourier series to the model together with seasonal dummies.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">xreg_train</span> <span class="op">&lt;-</span> <span class="fu">forecast</span><span class="fu">::</span><span class="fu"><a href="https://pkg.robjhyndman.com/forecast/reference/seasonaldummy.html" class="external-link">seasonaldummy</a></span><span class="op">(</span><span class="va">AirPassengers</span><span class="op">)</span></span>
<span></span>
<span><span class="va">newxreg</span> <span class="op">&lt;-</span> <span class="fu">forecast</span><span class="fu">::</span><span class="fu"><a href="https://pkg.robjhyndman.com/forecast/reference/seasonaldummy.html" class="external-link">seasonaldummy</a></span><span class="op">(</span><span class="va">AirPassengers</span>, h <span class="op">=</span> <span class="fl">21</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ARml.html">ARml</a></span><span class="op">(</span><span class="va">AirPassengers</span>, max_lag <span class="op">=</span> <span class="fl">4</span>, caret_method <span class="op">=</span> <span class="st">"cubist"</span>, </span>
<span>            seasonal <span class="op">=</span> <span class="cn">FALSE</span>, xreg <span class="op">=</span> <span class="va">xreg_train</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; initial_window = NULL. Setting initial_window = 132</span></span>
<span></span>
<span><span class="va">fc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/forecast.html" class="external-link">forecast</a></span><span class="op">(</span><span class="va">fit</span>, h <span class="op">=</span> <span class="fl">12</span>, level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">80</span>, <span class="fl">95</span>, <span class="fl">99</span><span class="op">)</span>, xreg <span class="op">=</span> <span class="va">newxreg</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">fc</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example6-1.png" width="100%"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="reference/get_var_imp.html">get_var_imp</a></span><span class="op">(</span><span class="va">fc</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example6-2.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="conformal-prediction-intervals">Conformal Prediction Intervals<a class="anchor" aria-label="anchor" href="#conformal-prediction-intervals"></a>
</h2>
<p>As of version 0.1.2, caretForecast implements <strong>horizon-specific conformal prediction intervals</strong>. This approach provides properly calibrated prediction intervals that naturally widen with forecast horizon (trumpet shape), addressing a common limitation of ML-based forecasting methods.</p>
<div class="section level3">
<h3 id="how-it-works">How it works<a class="anchor" aria-label="anchor" href="#how-it-works"></a>
</h3>
<p>When <code>calibrate = TRUE</code> (the default), <code><a href="reference/ARml.html">ARml()</a></code> performs rolling-origin calibration using out-of-sample forecasts to compute nonconformity scores for each forecast horizon. This ensures that the prediction intervals have the correct coverage probability.</p>
</div>
<div class="section level3">
<h3 id="key-parameters">Key parameters<a class="anchor" aria-label="anchor" href="#key-parameters"></a>
</h3>
<ul>
<li>
<code>calibrate</code>: Logical. If TRUE (default), performs horizon-specific calibration for conformal prediction intervals</li>
<li>
<code>calibration_horizon</code>: Maximum forecast horizon for calibration. Defaults to <code>2 * frequency(y)</code> for seasonal data or 10 for non-seasonal data</li>
<li>
<code>n_cal_windows</code>: Number of rolling windows for calibration. Automatically determined based on data length (max 50)</li>
</ul>
</div>
<div class="section level3">
<h3 id="example-with-calibrated-intervals">Example with calibrated intervals<a class="anchor" aria-label="anchor" href="#example-with-calibrated-intervals"></a>
</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit model with conformal calibration (default)</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ARml.html">ARml</a></span><span class="op">(</span><span class="va">AirPassengers</span>, max_lag <span class="op">=</span> <span class="fl">12</span>, caret_method <span class="op">=</span> <span class="st">"ridge"</span>,</span>
<span>            verbose <span class="op">=</span> <span class="cn">FALSE</span>, calibrate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; initial_window = NULL. Setting initial_window = 124</span></span>
<span></span>
<span><span class="co"># Forecast with prediction intervals</span></span>
<span><span class="va">fc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/forecast.html" class="external-link">forecast</a></span><span class="op">(</span><span class="va">fit</span>, h <span class="op">=</span> <span class="fl">24</span>, level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">80</span>, <span class="fl">95</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The intervals widen appropriately with forecast horizon</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">fc</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example_conformal-1.png" width="100%"></p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=caretForecast" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/taf-society/caretForecast/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/taf-society/caretForecast/issues" class="external-link">Report a bug</a></li>
<li><a href="https://github.com/taf-society/caretForecast/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing caretForecast</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://github.com/taf-society" class="external-link">Resul Akay</a> <br><small class="roles"> Author, maintainer </small>   </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/taf-society/caretForecast/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/taf-society/caretForecast/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://github.com/taf-society/caretForecast/actions/workflows/pkgdown.yaml" class="external-link"><img src="https://github.com/taf-society/caretForecast/actions/workflows/pkgdown.yaml/badge.svg" alt="pkgdown"></a></li>
<li><a href="https://app.codecov.io/gh/taf-society/caretForecast" class="external-link"><img src="https://codecov.io/gh/taf-society/caretForecast/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://CRAN.R-project.org/package=caretForecast" class="external-link"><img src="https://www.r-pkg.org/badges/version/caretForecast" alt="CRAN status"></a></li>
<li><a href="https://CRAN.R-project.org/package=caretForecast" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/grand-total/caretForecast" alt="CRAN downloads"></a></li>
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing" class="external-link"><img src="https://img.shields.io/badge/lifecycle-maturing-blue.svg" alt="Lifecycle: maturing"></a></li>
<li><a href="https://www.gnu.org/licenses/gpl-3.0" class="external-link"><img src="https://img.shields.io/badge/License-GPLv3-blue.svg" alt="License: GPL v3"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/taf-society" class="external-link">Resul Akay</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
